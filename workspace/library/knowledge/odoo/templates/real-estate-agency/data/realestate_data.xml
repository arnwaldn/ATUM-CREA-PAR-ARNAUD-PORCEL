<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        <!-- Property Types and Features are managed through selection fields -->

        <!-- Email Template for Visit Confirmation -->
        <record id="email_template_visit_confirmation" model="mail.template">
            <field name="name">Visit Confirmation</field>
            <field name="model_id" ref="model_realestate_visit"/>
            <field name="email_from">{{ (object.agent_id.email or user.email) }}</field>
            <field name="email_to">{{ object.visitor_id.email }}</field>
            <field name="subject">Visit Confirmation - {{ object.property_id.title }}</field>
            <field name="body_html"><![CDATA[
<div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <h2>Visit Confirmation</h2>
    <p>Dear {{ object.visitor_id.name }},</p>
    <p>Your visit has been confirmed with the following details:</p>

    <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 20px 0;">
        <p><strong>Property:</strong> {{ object.property_id.title }}</p>
        <p><strong>Address:</strong> {{ object.property_id.street or '' }}, {{ object.property_id.city }}</p>
        <p><strong>Date:</strong> {{ object.date }}</p>
        <p><strong>Time:</strong> {{ '%02d:%02d' % (int(object.time_start), int((object.time_start % 1) * 60)) }}</p>
        <p><strong>Agent:</strong> {{ object.agent_id.name }}</p>
    </div>

    <p>If you need to reschedule or cancel, please contact us as soon as possible.</p>

    <p>Best regards,<br/>
    {{ object.agent_id.name }}<br/>
    {{ object.agent_id.phone or '' }}</p>
</div>
            ]]></field>
        </record>

        <!-- Cron for Mandate Expiry Check -->
        <record id="ir_cron_mandate_expiry" model="ir.cron">
            <field name="name">Real Estate: Check Mandate Expiry</field>
            <field name="model_id" ref="model_realestate_mandate"/>
            <field name="state">code</field>
            <field name="code">model._cron_check_expiry()</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field>
            <field name="active">True</field>
        </record>

        <!-- Cron for Offer Expiry Check -->
        <record id="ir_cron_offer_expiry" model="ir.cron">
            <field name="name">Real Estate: Check Offer Expiry</field>
            <field name="model_id" ref="model_realestate_offer"/>
            <field name="state">code</field>
            <field name="code">model._cron_check_expired()</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field>
            <field name="active">True</field>
        </record>
    </data>
</odoo>
